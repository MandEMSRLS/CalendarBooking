<!DOCTYPE html>
<html>
	<head>
	  <base target="_top">
	  <style>
		.page {
		  display: none; /* Hide all pages by default */
		}
		.page.active {
		  display: block; /* Show the active page */
		}
		 

	  </style>
		<!-- Bootstrap CSS -->
		<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" xintegrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">

		<!-- DataTables CSS -->
		<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/2.0.8/css/dataTables.dataTables.min.css">
		<!-- DataTables Buttons CSS -->
		<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/buttons/3.0.2/css/buttons.dataTables.min.css">
	</head>
	<body>
		<div class=" mt-5">
		
			<!-- row 1 report page -->
			<div  id="page2" class="page m-1 active">
				
				<h2> Booking Form</h2>
				<form id="submissionForm" class="p-2" >
					<div class="row">
						<div class="col-md-4">
							<div class="form-group m-2">
								<label for="SectorName" style="float:left;"> Sector Name <b class="text-danger">*</b> </label>
								<select class="form-control" id="SectorName" name="SectorName" required>
									<!-- <option value="-1">Select Option -- </option> -->
									<option value="Monitoring & Evaluation">Monitoring & Evaluation</option>
									<option value="Admin">Admin</option>
									<option value="Human Resource">Human Resource</option>
									<option value="Institution Building  and Capacity Building">Institution Building  and Capacity Building</option>
									<option value="Social Inclusion  and Social Development">Social Inclusion  and Social Development</option>
									<option value="Livelihood - FARM">Livelihood FARM</option>
									<option value="Livelihood - NON-FARM">Livelihood - NON-FARM</option>
									<option value="Financial Inclusion">Financial Inclusion</option>		
									<option value="ACCOUNTS">ACCOUNTS</option>								
								</select>
							</div>
						</div>
						<div class="col-md-4">
							<div class="form-group m-2">
								<label for="ContactName" style="float:left;"> Concern Person Name <b class="text-danger">*</b></label>
								<input type="text" class="form-control" id="ContactName" name="ContactName" placeholder="Enter Contact Person Name" required />
							</div>
						</div>
						<div class="col-md-4">
							<div class="form-group m-2">
								<label for="contactNo" style="float:left;"> Contact Person Contact <b class="text-danger">*</b> </label>
								<input type="number" class="form-control" id="contactNo" name="contactNo"  placeholder="Enter Person Contact" required />
							</div>
						</div>
					</div>
					<div class="row">
						<div class="col-md-4">
							<div class="form-group m-2">
								<label for="STime" style="float:left;"> Meeting Date <b class="text-danger">*</b></label>
								<input type="date" class="form-control" id="dt" name="dt" placeholder="Meeting Date" required />
							</div>
						</div>
						<div class="col-md-4">
							<div class="form-group m-2">
								<label for="MeetingType" style="float:left;"> Meeting Type <b class="text-danger">*</b> </label>
								<input type="text" class="form-control" id="MeetingType" name="MeetingType" value="Fixed" readonly required />
								
								<!-- <select class="form-control" id="MeetingType" name="MeetingType">
									 <option value="-1">Select Option -- </option> 
									 <option value="Open">Open(End Time no need to Define)</option> 
									<option value="Fixed">Fixed (End Time Required)</option>
								</select> --> 
								<!-- <label for="ETime" id="ETLB" class="mt-2" style="display:none;"> End Time <b class="text-danger">*</b> </label>
								<input type="time" class="form-control mt-2" id="ETime" name="ETime" placeholder="End Time"   style="display: none;"/> -->
							</div> 
						</div>
						
						<div class="col-md-4">
							<div class="form-group m-2">
								<label for="MTopic" style="float:left;"> Topic Of the Meeting <b class="text-danger">*</b></label>
								<input type="text" class="form-control" id="MTopic" name="MTopic" placeholder="Topic of the Meeting" required />
							</div>
						</div>
						
						<div class="col-md-4">
							<div class="form-group m-2">
								<label for="STime" style="float:left;"> Start  Time  <b class="text-danger">*</b></label>
								<input type="time" class="form-control" id="STime" name="STime" placeholder="Start Time" required />
							</div>
						</div>
						<div class="col-md-4">
							<div class="form-group m-2">
								<label for="ETime" style="float:left;"> End  Time  <b class="text-danger">*</b></label>
								<input type="time" class="form-control mt-2" id="ETime" name="ETime" placeholder="End Time" required />
							</div>
						</div>
						<div class="col-md-4">
							<div class="form-group m-2">
								<label for="meetingMode" style="float:left;"> Mode  <b class="text-danger">*</b></label>
								<select class="form-control" id="meetingMode" name="meetingMode">
									<!-- <option value="-1">Select Option -- </option> -->
									<option value="Offline">Offline</option>
									<option value="Online">Online</option>
								</select>
								<input type="text" class="form-control mt-2" id="VClink" name="VClink" placeholder="VC Link"   style="display: none;" />
							</div>  
						</div>
						<div class="col-md-12">
							<div class="form-group m-2">
								<label for="remarks" style="float:left;"> Remarks  </label>
									<textarea id="remarks" name="remarks" rows="4" cols="50" class="form-control mt-2"> </textarea>
							</div>  
						</div>
						<span id="msg" name="msg" style="display: none; float:right;" class="text-primary h1 text-center"></span> 
					</div> 
					 <button type="submit" class="btn btn-primary rounded-3" style="float:right" id="subm">Submit</button>
				</form>
				
			</div>
		</div>
	
		<!-- jQuery (required by DataTables) -->
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
		<!-- Bootstrap Bundle with Popper (required for Bootstrap's JavaScript components like modals) -->
		<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" xintegrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
		<!-- DataTables Core JS -->
		<script type="text/javascript" src="https://cdn.datatables.net/2.0.8/js/dataTables.min.js"></script>
		<!-- DataTables Buttons Extension JS -->
		<script type="text/javascript" src="https://cdn.datatables.net/buttons/3.0.2/js/dataTables.buttons.min.js"></script>
		<!-- JSZip (for Excel export) -->
		<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
		<!-- pdfmake (for PDF export - optional, but good practice to include with Buttons) -->
		<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.2.7/pdfmake.min.js"></script>
		<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.2.7/vfs_fonts.js"></script>
		<!-- Buttons HTML5 export JS (for Excel, CSV, PDF) -->
		<script type="text/javascript" src="https://cdn.datatables.net/buttons/3.0.2/js/buttons.html5.min.js"></script>
		<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.2.7/pdfmake.min.js"></script>
		<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.2.7/vfs_fonts.js"></script>

		<script>
				
		WEB_APP_URL="https://script.google.com/macros/s/AKfycbybRl3s58j5_lRFVN0Muw6CnvIlvKWcOnzmMKt3D4Zu9T91GnXpRm5aBOsy8PWgYZvf/exec";
		
			//institutionTypetext,
			 $('#MeetingType').change(function() {
				if($('#MeetingType').val()=='Fixed')
				{
					$('#ETLB').show();
					$('#ETime').show();
				}
				else{
				$('#ETime').val('');
				$('#ETime').hide();
				$('#ETLB').hide();
				}
			});
			
			//check for sector Name 
			$('#SectorName').change(function() {
				if($('#SectorName').val()=='-1')
				{
					$('#msg').show();
					$('#msg').text('Please Select Sector Name');
				}
			});
			
			$('#contactNo').change(function() {
			 //alert($('#contactNo').val().length);
			 if ($('#contactNo').val().length != 10)
			 {
				$('#msg').show();
				$('#msg').text('Contact number cannot be Less or More than 10');
				$('#contactNo').val("");					 
			 }	  
			});
			
			
			//institutionTypetext,
			$('#meetingMode').change(function() {
				if($('#meetingMode').val()=='Online')
				{
					$('#VClink').show();
				}
				else{
				$('#VClink').val('');
				$('#VClink').hide();
				}
			});
						
			const submissionForm = document.getElementById('submissionForm');
			function showPage(pageId) {
			  // Hide all pages
			  var pages = document.querySelectorAll('.page');
			  pages.forEach(function(page) {
				page.classList.remove('active');
			  });

			  // Show the selected page
			  var activePage = document.getElementById(pageId);
			  if (activePage) {
				activePage.classList.add('active');
			  }
			}
			
			//reset form 
			function resetMyForm() {
			  document.getElementById('submissionForm').reset();
			}
	
			//submit data here
			submissionForm.addEventListener('submit', async (event) => {
				event.preventDefault(); // Prevent the default form submission
				const formData = new FormData(submissionForm);
				try {
				
					$("#subm").attr("disabled", true);
				    //$(this).find('input[type="submit"]').attr('disabled', 'disabled');
				
					// ############################	 do the checking here  ################
					$('#meetingMode').change(function() {
						if($('#meetingMode').val()=='Online')
						{
							if($('#VClink').val()=='')
							{
								$('#msg').show();
								$('#msg').text('link cannot be Empty');
								return 0;
							}
						}
					});
					
					if($('#MeetingType').val()=='Fixed')
					{
						if($('#ETime').val()=='')
						{
							$('#msg').show();
							$('#msg').text('End time cannot be Empty');
							return 0;
						}
					}
					
					
					
					const response = await fetch(WEB_APP_URL, {
						method: 'POST',
						body: formData
					});

					if (!response.ok) {
						const errorText = await response.text();
						throw new Error(`HTTP error! Status: ${response.status} - ${response.statusText}. Response: ${errorText}`);
					}

					const result = await response.json();
					if (result.success) {
						$('#msg').show();
						$('#msg').text('Booking Sucessfully..');
//window.location.href = "https://sites.google.com/view/conferencerbooking/success";
 window.open('https://sites.google.com/view/conferencerbooking/success', '_blank');
						//window.location.href = "success.html";
						resetMyForm();		
					} else {
						console.log(`Submission failed: ${result.message}`, 'error');
					}
				} catch (error) {
					console.error('Fetch error (POST):', error);
				}
			});
			
		</script>

	</body>
</html>
